/*! solo_inventory_forecaster 2016-02-12*/
var app=angular.module("routeApp",["ngRoute","ngSanitize","ngCsv"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/signin.html",controller:"MainController"}).when("/success",{templateUrl:"views/partpicker.html",controller:"PartPicker"}).when("/failure",{templateUrl:"views/signin.html",controller:"MainController"}).when("/register",{templateUrl:"views/register.html",controller:"RegisterController"}).when("/partpicker",{templateUrl:"views/partpicker.html",controller:"PartPicker"}).when("/forecaster",{templateUrl:"views/forecaster.html",controller:"Forecaster"}),b.html5Mode(!0)}]),app.controller("MainController",["$scope","$http","$location","UserService",function(a,b,c,d){a.userData=d.userData,a.invalidLogin=!1,a.validLogin=!1,b.get("getUser").then(function(b){console.log("getUser: ",b),a.user=b}),a.sendDataAndStuff=function(){d.makeLoginRequest(a.data),a.invalidLogin=!d.userData.logInUser,a.validLogin=d.userData.logInUser,console.log("$scope.userData: ",a.userData)}}]),app.controller("RegisterController",["$scope","$http","$location",function(a,b,c){a.user={username:"",password:""},b.get("getUser").then(function(b){console.log("getUser: ",b),a.user=b}),a.sendDataAndStuff=function(){UserService.makeLoginRequest(a.data)},a.register=function(){var d=a.user.username+"/"+a.user.password;b.post("/registerMe/"+d).then(function(a){a.data.username&&c.path("/")})}}]),app.controller("FailController",["$scope","$http","$location","UserService",function(a,b,c,d){a.userData=d.userData,b.get("getUser").then(function(b){console.log("getUser: ",b),a.user=b}),a.sendDataAndStuff=function(){d.makeLoginRequest(a.data)}}]),app.controller("PartPicker",["$scope","$http","UserService",function(a,b,c){function d(){b.get("/api/pullAllParts").success(function(b){console.log(b),a.allParts=b})}a.userData=c.userData,a.allParts=[];var e={},f={},g={},h={},i={},j={};d(),a.postPartsOrder=function(){b["delete"]("/api/deleteOrder").success(function(a){console.log("deleteOrder response: ",a)}),a.allParts.value1&&(console.log("id1: ",a.allParts[a.allParts.id1-1].id),console.log("Value1: ",a.allParts.value1),e={id:a.allParts[a.allParts.id1-1].id,value:a.allParts.value1},console.log("part1 object: ",e),b.post("/api/saveToOrder",e).then(function(a){console.log("saveToOrder response: ",a)})),a.allParts.value2&&(console.log("id2: ",a.allParts[a.allParts.id2-1].id),console.log("Value2: ",a.allParts.value2),f={id:a.allParts[a.allParts.id2-1].id,value:a.allParts.value2},console.log("part2 object: ",f),b.post("/api/saveToOrder",f).then(function(a){console.log("saveToOrder response: ",a)})),a.allParts.value3&&(console.log("id3: ",a.allParts[a.allParts.id3-1].id),console.log("Value3: ",a.allParts.value3),g={id:a.allParts[a.allParts.id3-1].id,value:a.allParts.value3},console.log("part3 object: ",g),b.post("/api/saveToOrder",g).then(function(a){console.log("saveToOrder response: ",a)})),a.allParts.value4&&(console.log("id4: ",a.allParts[a.allParts.id4-1].id),console.log("Value4: ",a.allParts.value4),h={id:a.allParts[a.allParts.id4-1].id,value:a.allParts.value4},console.log("part4 object: ",h),b.post("/api/saveToOrder",h).then(function(a){console.log("saveToOrder response: ",a)})),a.allParts.value5&&(console.log("id5: ",a.allParts[a.allParts.id5-1].id),console.log("Value5: ",a.allParts.value5),i={id:a.allParts[a.allParts.id5-1].id,value:a.allParts.value5},console.log("part5 object: ",i),b.post("/api/saveToOrder",i).then(function(a){console.log("saveToOrder response: ",a)})),a.allParts.value6&&(console.log("id6: ",a.allParts[a.allParts.id6-1].id),console.log("Value6: ",a.allParts.value6),j={id:a.allParts[a.allParts.id6-1].id,value:a.allParts.value6},console.log("part6 object: ",j),b.post("/api/saveToOrder",j).then(function(a){console.log("saveToOrder response: ",a)}))}}]),app.controller("Forecaster",["$scope","$http","UserService",function(a,b,c){function d(){b.get("/api/pullOrder").success(function(b){console.log(b),a.partsOrder=b,e()})}function e(){for(var b=0;b<a.partsOrder.length;b++)console.log("Qty to Order: ",a.partsOrder[b].quantity_required-a.partsOrder[b].quantity_available),a.partsOrder[b].quantity_needed=a.partsOrder[b].quantity_required-a.partsOrder[b].quantity_available;f(),console.log("Complete Order: ",a.partsOrder)}function f(){for(var b=0;b<a.partsOrder.length;b++)a.createCSV.push(a.partsOrder[b])}a.userData=c.userData,a.partsOrder=[],a.createCSV=[{part_number:"Part Number",manufacturer:"Manufacturer",part_description:"Part Description",quantity_required:"Quantity Required",quantity_available:"Quantity Available",quantity_needed:"Quantity to Order"}],d()}]),app.factory("UserService",["$http","$location",function(a,b){var c={},d=function(d){a.post("/",d).then(function(a){console.log("makeLoginRequest response: ",a),c.server=a.data,c.username=a.data.username,c.isLoggedIn=!0,c.logInTime=new Date,a.data.username?(c.logInUser=!0,b.path("success")):(console.log("Username not captured."),c.logInUser=!1,b.path(""))})};return{userData:c,makeLoginRequest:d}}]);