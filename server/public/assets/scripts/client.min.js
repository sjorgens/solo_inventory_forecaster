/*! solo_inventory_forecaster 2016-02-14*/
var app=angular.module("routeApp",["ngRoute","ngSanitize","ngCsv"]);app.config(["$routeProvider","$locationProvider",function(a,b){a.when("/",{templateUrl:"views/signin.html",controller:"MainController"}).when("/success",{templateUrl:"views/partpicker.html",controller:"PartPickerController"}).when("/failure",{templateUrl:"views/signin.html",controller:"MainController"}).when("/register",{templateUrl:"views/register.html",controller:"RegisterController"}).when("/partpicker",{templateUrl:"views/partpicker.html",controller:"PartPickerController"}).when("/forecaster",{templateUrl:"views/forecaster.html",controller:"ForecasterController"}),b.html5Mode(!0)}]),app.controller("MainController",["$scope","$http","$location","UserService",function(a,b,c,d){a.userData=d.userData,a.userData.notValidUser=!0,b.get("getUser").then(function(b){a.user=b}),a.sendDataAndStuff=function(){d.makeLoginRequest(a.data)},a.signOut=function(){b.get("/signOut").then(function(b){console.log("Sign Out Response: ",b),a.userData.logInUser=!1,a.userData.notValidUser=!0})}}]),app.controller("RegisterController",["$scope","$http","$location",function(a,b,c){a.user={username:"",password:""},b.get("getUser").then(function(b){a.user=b}),a.sendDataAndStuff=function(){UserService.makeLoginRequest(a.data)},a.register=function(){var d=a.user.username+"/"+a.user.password;b.post("/registerMe/"+d).then(function(a){a.data.username&&c.path("/")})}}]),app.controller("FailController",["$scope","$http","$location","UserService",function(a,b,c,d){a.userData=d.userData,b.get("getUser").then(function(b){a.user=b}),a.sendDataAndStuff=function(){d.makeLoginRequest(a.data)}}]),app.controller("PartPickerController",["$scope","$http","UserService",function(a,b,c){function d(){b.get("/api/pullAllParts").success(function(b){a.allParts=b})}a.userData=c.userData,a.allParts=[];var e={},f={},g={},h={},i={},j={};d(),a.postPartsOrder=function(){b["delete"]("/api/deleteOrder").success(function(a){}),a.allParts.value1&&(e={id:a.allParts[a.allParts.id1-1].id,value:a.allParts.value1},b.post("/api/saveToOrder",e).then(function(a){})),a.allParts.value2&&(f={id:a.allParts[a.allParts.id2-1].id,value:a.allParts.value2},b.post("/api/saveToOrder",f).then(function(a){})),a.allParts.value3&&(g={id:a.allParts[a.allParts.id3-1].id,value:a.allParts.value3},b.post("/api/saveToOrder",g).then(function(a){})),a.allParts.value4&&(h={id:a.allParts[a.allParts.id4-1].id,value:a.allParts.value4},b.post("/api/saveToOrder",h).then(function(a){})),a.allParts.value5&&(i={id:a.allParts[a.allParts.id5-1].id,value:a.allParts.value5},b.post("/api/saveToOrder",i).then(function(a){})),a.allParts.value6&&(j={id:a.allParts[a.allParts.id6-1].id,value:a.allParts.value6},b.post("/api/saveToOrder",j).then(function(a){}))}}]),app.controller("ForecasterController",["$scope","$http","UserService",function(a,b,c){function d(){b.get("/api/pullOrder").success(function(b){a.partsOrder=b,e()})}function e(){for(var b=0;b<a.partsOrder.length;b++)a.partsOrder[b].quantity_needed=a.partsOrder[b].quantity_required-a.partsOrder[b].quantity_available;f()}function f(){for(var b=0;b<a.partsOrder.length;b++)a.createCSV.push(a.partsOrder[b])}a.userData=c.userData,a.partsOrder=[],a.createCSV=[{part_number:"Part Number",manufacturer:"Manufacturer",part_description:"Part Description",quantity_required:"Quantity Required",quantity_available:"Quantity Available",quantity_needed:"Quantity to Order"}],d()}]),app.factory("UserService",["$http","$location",function(a,b){var c={},d=function(d){a.post("/",d).then(function(a){c.server=a.data,c.username=a.data.username,c.isLoggedIn=!0,c.logInTime=new Date,a.data.username?(c.logInUser=!0,c.notValidUser=!0,b.path("success")):(c.logInUser=!1,c.notValidUser=!1,b.path(""))})};return{userData:c,makeLoginRequest:d}}]);